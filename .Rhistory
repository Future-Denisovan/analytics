New_Q64_3 <- demand_change(0.05,-0.05,-1.4867,0.9028, -0.2809, basevolume64)
New_Q128_4 <- demand_change(-0.05, 0.05,-2.3836, 0.2097,1.1648, basevolume128)
New_Q64_4 <- demand_change(-0.05,0.05,-1.4867, 0.9028, -0.2809, basevolume64)
Profit1 = (New_Q128_1 * ((baseprice128*1.05*0.75) - 0.027*128)) + (New_Q64_1 * ((baseprice64*1.05*0.75) - 0.027*64))
Profit2 = (New_Q128_2 * ((baseprice128*0.95*0.75) - 0.027*128)) + (New_Q64_2 * ((baseprice64*0.95*0.75) - 0.027*64))
Profit3 = (New_Q128_3 * ((baseprice128*1.05*0.75) - 0.027*128)) + (New_Q64_3 * ((baseprice64*0.95*0.75) - 0.027*64))
Profit4 = (New_Q128_4 * ((baseprice128*0.95*0.75) - 0.027*128)) + (New_Q64_4 * ((baseprice64*1.05*0.75) - 0.027*64))
library(scales)
del_price_128 = c(0, 0.05, -0.05, 0.05, -0.05)
del_price_64 = c(0, 0.05, -0.05, -0.05, 0.05)
q_128 = c(basevolume128, New_Q128_1, New_Q128_2, New_Q128_3, New_Q128_4)
q_64 = c(basevolume64, New_Q64_1, New_Q64_2, New_Q64_3, New_Q64_4)
#TotalProfitsW = c(TotalProfit1, TotalProfit2, TotalProfit3, TotalProfit4)
TotalProfitsR = c(BaseTotalProfit, Profit1, Profit2, Profit3, Profit4)
ChangeInPrice = c("Base Price", "Both +", "Both-", "T128 + T64 -", "T128 - T64 +")
Color = c(1, 1, 2, 2,2)
Price_Change<- as.factor(paste('128',del_price_128,'64',del_price_64, sep = "|"))
NewTable <- data.frame(del_price_128, del_price_64, q_128, q_64,Price_Change, TotalProfitsR, ChangeInPrice, Color)
NewTable
# ggplot(data = NewTable, aes(ChangeInPrice,TotalProfitsR, color = ChangeInPrice)) +
#    geom_point(size=10,show.legend = NA) +
#    theme_classic() +
#    scale_y_continuous(labels = comma) +
#    geom_label(
#     label="Profit from Recommended change",
#     x=1.75,
#     y=2400500,
#     label.padding = unit(0.55, "lines"), # Rectangle size around label
#     label.size = 0.35,
#     color = "black")
plot2 <-
ggplot(data = NewTable, aes(reorder(ChangeInPrice,TotalProfitsR), TotalProfitsR, fill = Color)) +
geom_col() +
theme_classic() +
theme(legend.position = "none") +
xlab("Change in Price") +
ylab("Total Profit $") +
ggtitle("Which One is Higher Than the Base Profit?")
plot2
New_Q128_5 <- demand_change(0.05, 0, -2.11, 0.211, 1.1648, basevolume128)
New_Q64_5 <- demand_change(0.05, 0 ,1.16,-1.585 , -0.2809, basevolume64)
New_Q128_6 <- demand_change(0, 0.05, -2.11, 0.211, 1.1648, basevolume128)
New_Q64_6 <- demand_change(0, 0.05 ,1.16,-1.585 , -0.2809, basevolume64)
New_Q128_7 <- demand_change(-0.05, 0, -2.11, 0.211, 1.1648, basevolume128)
New_Q64_7 <- demand_change(-0.05, 0 ,1.16,-1.585 , -0.2809, basevolume64)
New_Q128_8 <- demand_change(0, -0.05, -2.11, 0.211, 1.1648, basevolume128)
New_Q64_8 <- demand_change(0, -0.05 ,1.16,-1.585 , -0.2809, basevolume64)
#Increase price 128 by 5% but keep 64 the same
Profit5 = (New_Q128_5 * ((baseprice128*1.05*0.75) - 0.027*128)) + (New_Q64_5 * ((baseprice64*1.0*0.75) - 0.027*64))
#Keep price 128 the same but increase price 64 by 5%
Profit6 = (New_Q128_6 * ((baseprice128*1.0*0.75) - 0.027*128)) + (New_Q64_6 * ((baseprice64*1.05*0.75) - 0.027*64))
#Decrease price 128 by 5% but keep 64 the same
Profit7 = (New_Q128_7 * ((baseprice128*.95*0.75) - 0.027*128)) + (New_Q64_7 * ((baseprice64*1.0*0.75) - 0.027*64))
#Keep price 128 the same but decrease price 64 by 5%
Profit8 = (New_Q128_8 * ((baseprice128*1.0*0.75) - 0.027*128)) + (New_Q64_8 * ((baseprice64*0.95*0.75) - 0.027*64))
NewProfits <- c(Profit5, Profit6, Profit7, Profit8)
NewTable2 <- data.frame(TotalProfitsR, NewProfits)
Profit3 = (New_Q128_3 * ((baseprice128*1.05*0.75) - (0.027*128))) + (New_Q64_3 * ((baseprice64*0.95*0.75) - (0.027*64)))
library(scales)
del_price_128 = c(0, 0.05, -0.05, 0.05, -0.05)
del_price_64 = c(0, 0.05, -0.05, -0.05, 0.05)
q_128 = c(basevolume128, New_Q128_1, New_Q128_2, New_Q128_3, New_Q128_4)
q_64 = c(basevolume64, New_Q64_1, New_Q64_2, New_Q64_3, New_Q64_4)
#TotalProfitsW = c(TotalProfit1, TotalProfit2, TotalProfit3, TotalProfit4)
TotalProfitsR = c(BaseTotalProfit, Profit1, Profit2, Profit3, Profit4)
ChangeInPrice = c("Base Price", "Both +", "Both-", "T128 + T64 -", "T128 - T64 +")
Color = c(1, 1, 2, 2,2)
Price_Change<- as.factor(paste('128',del_price_128,'64',del_price_64, sep = "|"))
NewTable <- data.frame(del_price_128, del_price_64, q_128, q_64,Price_Change, TotalProfitsR, ChangeInPrice, Color)
NewTable
totalprofit.4
knitr::opts_chunk$set(echo = TRUE)
library(psych)
library(tidyverse)
library(knitr)
library(broom)
df <- get(load('Detergent.Rdata'))
head(df, 20)
tail(df, 20)
describe(df)
str(df)
summary(df)
df$salestide128 <- df$p_tide128 * df$q_tide128
df$salestide64 <- df$p_tide64 * df$q_tide64
df$saleswisk64 <- df$p_wisk64 * df$q_wisk64
df$totalweeklysales <- df$salestide128 + df$salestide64 + df$saleswisk64
totalsales<- sum(df$totalweeklysales)
totaltide128 <- sum(df$salestide128)
totaltide64 <- sum(df$salestide64)
totalwisk64 <- sum(df$saleswisk64)
#Sanity Check
totalsales == sum(totaltide128, totaltide64, totalwisk64)
#Market share percentages
mktsharetide128 <- totaltide128/totalsales
mktsharetide64 <- totaltide64/totalsales
mktsharewisk64 <- totalwisk64/totalsales
#Mean, median, and standard deviation for weekly prices taken from:
summary.output <- describe(df)
#creating new variables
df$pricegap1 <- df$p_tide128 - df$p_tide64
df$pricegap2 <- df$p_tide64 - df$p_wisk64
#seeing how the price gaps behave in the dataset
describe(df[15:16])
histgap1 <- hist(df$pricegap1, col = "steelblue3", breaks = 16, main = "Histogram of Pricegap1", xlab = "Price of Tide128oz - Tide64oz", ylab = "# of weekly store occurrences")
histgap1
histgap2 <- hist(df$pricegap2, col = "firebrick1", breaks = 24, main = "Histogram of Pricegap2", xlab = "Price of Tide64oz - Wisk64oz", ylab = "# of weekly store occurrences")
histgap2
df$velocity128 <- df$q_tide128/df$acv
df$velocity64 <- df$q_tide64/df$acv
df$velocitywisk <- df$q_wisk64/df$acv
head(df)
#Tide128
lm1 <- lm(log(velocity128) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64), data = df)
summary(lm1)
#Tide64
lm2 <- lm(log(velocity64) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64), data = df)
summary(lm2)
#Tide128
lm3 <- lm(log(velocity128) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64) + week, data = df)
summary(lm3)
#Tide64
lm4 <- lm(log(velocity64) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64) + week, data = df)
summary(lm4)
describe(df)
totalstoreweeks <- count(df)
total_promos <-sum(df$promoflag)
promo_ratio <-total_promos/totalstoreweeks
promo_ratio
#Creating NON-promo df
df2 <- subset(df, promoflag == 0)
str(df2)
#Tide128
lm5 <- lm(log(velocity128) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64) + week, data = df2)
summary(lm5)
#Tide64
lm6 <- lm(log(velocity64) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64) + week, data = df2)
summary(lm6)
#Tide128
lm7 <- lm(log(velocity128) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64) + week + factor(store), data = df2)
lm7DF <- tidy(lm7)
kable(lm7DF[1:5,], digits = 4)
#Tide64
lm8 <- lm(log(velocity64) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64) + week + factor(store), data = df2)
lm8DF <- tidy(lm8)
kable(lm8DF[1:5,], digits = 4)
lm9 <- lm(log(q_tide128) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64) + week + factor(store), data = df2)
lm9DF <- tidy(lm9)
kable(lm9DF[1:5,], digits = 4)
#Tide64
lm10 <- lm(log(q_tide64) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64) + week + factor(store), data = df2)
lm10DF <- tidy(lm10)
kable(lm10DF[1:5,], digits = 4)
baseprice128 <- mean(df2$p_tide128)
baseprice128
baseprice64 <- mean(df2$p_tide64)
baseprice64
numstores <- 86
# Base Volume = # of Stores * # Weeks in year * Avg. Sales of Product
basevolume128 <- numstores * 52 * mean(df2$q_tide128)
basevolume128
# Base Volume = # of Stores * # Weeks in year * Avg. Sales of Product
basevolume64 <- numstores * 52 * mean(df2$q_tide64)
basevolume64
#Storing inputs and finding cost per product
retail.margin <- .25
costperoz <- .027
costper128 <- costperoz * 128
costper64 <- costperoz * 64
costper128
costper64
# Finding Base Revenue (base price * base volume)
baserevenue128 <- baseprice128 * basevolume128
baserevenue64 <- baseprice64 * basevolume64
# Plugging in to profit formula
# Profit = Quantity * (Price * (1-retailmargin)-Cost of product)
profit128 <- basevolume128 * (baseprice128*(1-retail.margin)- costper128)
profit128
profit64 <- basevolume64 * (baseprice64*(1-retail.margin)- costper64)
profit64
total.tide.profit <- profit128+profit64
total.tide.profit
#inputting elasticities from final 2 regressions (lm9 and lm10)
ownelas128 <- -2.3836
ownelas64 <- -1.4867
tide128cross1 <- 0.2097
tide128cross2 <- 1.1648
tide64cross1 <- 0.9028
tide64cross2 <- -0.2809
# Creating New Function
quantity.change <- function(gamma1, gamma2, gamma3, ownelas, crosselas1, crosselas2) {
quantityratio <- ((1+gamma1)^ownelas) * ((1+gamma2)^crosselas1) * ((1+gamma3)^crosselas2)
return(quantityratio)
}
newratio128.1 <- quantity.change(.05, .05, 0, ownelas128, tide128cross1, tide128cross2)
newratio128.2 <- quantity.change(-.05, -.05, 0, ownelas128, tide128cross1, tide128cross2)
newratio128.3 <- quantity.change(.05, -.05, 0, ownelas128, tide128cross1, tide128cross2)
newratio128.4 <- quantity.change(-.05, .05, 0, ownelas128, tide128cross1, tide128cross2)
newratio64.1 <- quantity.change(.05, .05, 0, ownelas64, tide64cross1, tide64cross2)
newratio64.2 <- quantity.change(-.05, -.05, 0, ownelas64, tide64cross1, tide64cross2)
newratio64.3 <- quantity.change(-.05, .05, 0, ownelas64, tide64cross1, tide64cross2)
newratio64.4 <- quantity.change(.05, -.05, 0, ownelas64, tide64cross1, tide64cross2)
vol128.1 <- newratio128.1 * basevolume128
vol128.2 <- newratio128.2 * basevolume128
vol128.3 <- newratio128.3 * basevolume128
vol128.4 <- newratio128.4 * basevolume128
vol64.1 <- newratio64.1 * basevolume64
vol64.1
vol64.2 <- newratio64.2 * basevolume64
vol64.3 <- newratio64.3 * basevolume64
vol64.4 <- newratio64.4 * basevolume64
vol64.4
#These amounts will be printed in the Question 6f table
profit128.1 <- vol128.1 * (((baseprice128*1.05)*(1-retail.margin)- costper128))
profit128.2 <- vol128.2 * (((baseprice128*.95)*(1-retail.margin)- costper128))
profit128.3 <- vol128.3 * (((baseprice128*1.05)*(1-retail.margin)- costper128))
profit128.4 <- vol128.4 * (((baseprice128*.95)*(1-retail.margin)- costper128))
profit64.1 <- vol64.1 * (((baseprice64*1.05)*(1-retail.margin)- costper64))
profit64.2 <- vol64.2 * (((baseprice64*.95)*(1-retail.margin)- costper64))
profit64.3 <- vol64.3 * (((baseprice64*.95)*(1-retail.margin)- costper64))
profit64.4 <- vol64.4 * (((baseprice64*1.05)*(1-retail.margin)- costper64))
totalprofit.1 <- profit128.1 + profit64.1
totalprofit.1 #is the total profit for scenario 1
totalprofit.2 <- profit128.2 + profit64.2
totalprofit.2 #is the total profit for scenario 2
totalprofit.3 <- profit128.3 + profit64.3
totalprofit.3 #is the total profit for scenario 3
totalprofit.4 <- profit128.4 + profit64.4
totalprofit.4 #is the total profit for scenario 4
# These profit totals will be transferred to the question 6f/6g table
New Profits
NewProfits
NewProfits <- c(Profit5, Profit6, Profit7, Profit8)
New_Q128_1 <- demand_change(0.05, 0.05, -2.3836, 0.2097,1.1648, basevolume128)
knitr::opts_chunk$set(echo = TRUE)
#install.packages('devtools')#Packages required
#devtools::install_github("ropensci/skimr")
#install.packages('arm')#to plot coefficients
load(file = "Detergent.RData")
dt <- detergent_DF
library(skimr)
library(psych)
library(ggplot2)
library(arm)
library(broom)
library(knitr)
skim(dt)
head(dt)
#Make Revenue column for each product
dt$T128Revenue <- dt$q_tide128 * dt$p_tide128
dt$T64Revenue <- dt$q_tide64 * dt$p_tide64
dt$WiskRevenue <- dt$q_wisk64 * dt$p_wisk64
TotalRevenue <- sum(dt$T128Revenue) + sum(dt$T64Revenue) + sum(dt$WiskRevenue)
T128Rev <- (sum(dt$T128Revenue) / TotalRevenue) * 100
T64Rev <- (sum(dt$T64Revenue) / TotalRevenue) * 100
WiskRev <- (sum(dt$WiskRevenue) / TotalRevenue) * 100
TotalRevenue1 <- format(round(TotalRevenue, 2), nsmall = 2)
T128Rev1 <- format(round(T128Rev, 2), nsmall = 2)
T64Rev1 <- format(round(T64Rev, 2), nsmall = 2)
WiskRev1 <- format(round(WiskRev, 2), nsmall = 2)
Mean128 <- mean(dt$p_tide128)
Mean64 <- mean(dt$p_tide64)
MeanW <- mean(dt$p_wisk64)
SD128 <- sd(dt$p_tide128)
SD64 <- sd(dt$p_tide64)
SDW <- sd(dt$p_wisk64)
Med128 <- median(dt$p_tide128)
Medn64 <- median(dt$p_tide64)
MednW <- median(dt$p_wisk64)
library(data.table)
Marketshare = c(T128Rev1, T64Rev1, WiskRev1)
MeanPrice = c(Mean128, Mean64, MeanW)
MedianPrice = c(Med128, Medn64, MednW)
Std.Dev = c(SD128, SD64, SDW)
Product <- c("Tide 128 oz", "Tide 64 oz", "Wisk 64 oz")
MarketShare <- data.frame(Product, Marketshare, MeanPrice, MedianPrice, Std.Dev)
describe(dt)
MarketShare
dt$PriceGap1 <- dt$p_tide128 - dt$p_tide64
dt$PriceGap2 <- dt$p_tide64 - dt$p_wisk64
MeanPG1 <- mean(dt$PriceGap1)
MeanPG2 <- mean(dt$PriceGap2)
SDPG1 <- sd(dt$PriceGap1)
SDPG2 <- sd(dt$PriceGap2)
MedPG1 <- median(dt$PriceGap1)
MedPG2 <- median(dt$PriceGap2)
MeanPriceGap = c(MeanPG1, MeanPG2)
MedianPriceGap = c(MedPG1, MedPG2)
Std.DevPriceGap = c(SDPG1, SDPG2)
PriceGap <- c("Tide128- Tide64", "Tide64 - Wisk64")
PriceGap <- data.frame(PriceGap, MeanPriceGap, MedianPriceGap, Std.DevPriceGap)
PriceGap
par(mfrow=c(1,2))#Set the plotting area into a 1*2 array
#Set axis to the same for better comparison
hist(dt$PriceGap1, freq = F, col = "steelblue", breaks = 50, xlab = "Price Gap 1 ($)", main = "Price Gap of Tide 128 - Tide 64",
xlim = c(-3,8))
hist(dt$PriceGap2, freq = F, col = "orange", breaks = 50, xlab = "Price Gap 2 ($)", main = "Price Gap of Tide 64 - Wisk 64",xlim = c(-3,8))
par(mfrow=c(1,1))
dt$svelocity128 <- (dt$q_tide128/dt$acv)
dt$svelocity64 <- (dt$q_tide64/dt$acv)
SalesVelocity128 <- sum(dt$svelocity128)
SalesVelocity64 <- sum(dt$svelocity64)
SalesVelocity128
SalesVelocity64
lm128 = lm(log(svelocity128) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64), data = dt)
lm64 = lm(log(svelocity64) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64), data = dt)
summary(lm128)
summary(lm64)
lm128_coef<- summary(lm128)$coefficients
lm64_coef<-summary(lm64)$coefficients#Lets graph these coefficients so we can see all these at a glance
pe_graph<-c(lm64_coef[2:4,1],lm128_coef[2:4,1])
pe_graph
barplot(pe_graph, main = "Price Elasticity", xlab = "Tide64's PE_______________________Tide128's PE", col = rainbow(6), names.arg = c('Cross Tide','Own', 'Cross Wisk','Own', 'Cross Tide', 'Cross Wisk' ))
dt$week<-as.integer(dt$week)
lm128_B <- lm(log(svelocity128) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64) +  week, data = dt)
lm64_B <- lm(log(svelocity64) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64) + week, data = dt)
lm128_Ba<-tidy(lm128_B)
lm64_Ba<-tidy(lm64_B)
kable(lm128_Ba[c(1:4),], digits = 4)
kable(lm64_Ba[c(1:4),], digits = 4)
summary(lm128_B)
summary(lm64_B)
lm128B_coef<- summary(lm128_B)$coefficients
lm64B_coef<-summary(lm64_B)$coefficients#Lets graph these coefficients so we can see all these at a glance
pe_graphB<-c(lm64B_coef[2:4,1],lm128B_coef[2:4,1])
pe_graphB
barplot(pe_graphB, main = "Price Elasticity", xlab = "Tide64's PE_______________________Tide128's PE", col = rainbow(6), names.arg = c('Cross Tide','Own', 'Cross Wisk','Own', 'Cross Tide', 'Cross Wisk' ))
library(tidytext)
# detergent_promos <- dt %>%
#    select(week, promoflag)
#    filter(promoflag == 1)
#
# totalweeks<-length(unique(dt$week))
#
# promoweeks <- length(unique(detergent_promos$week))
#
# store_week_fraction <- paste(promoweeks,totalweeks, sep = '/')
#
# store_week_fraction #Did we lose some data, there isn't the expected 300 weeks.
#
# sum(dt$promoflag)
#
detergent_DF_2 = subset(dt, promoflag != 1)
#In case I can't get the above to work
storeweeks <- count(dt)
promos <-sum(dt$promoflag)
PromoRatio <-promos/storeweeks
PromoRatio
detergent_DF_2$svelocity128 <- (detergent_DF_2$q_tide128/detergent_DF_2$acv)
detergent_DF_2$svelocity64 <- (detergent_DF_2$q_tide64/detergent_DF_2$acv)
SalesVelocity128_B <- sum(detergent_DF_2$svelocity128)
SalesVelocity64_B <- sum(detergent_DF_2$svelocity64)
lm128_C = lm(log(svelocity128) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64) +  week, data = detergent_DF_2)
lm64_C = lm(log(svelocity64) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64) + week, data = detergent_DF_2)
summary(lm128_C)
summary(lm64_C)
lm128_Ca<-tidy(lm128_C)
lm64_Ca<-tidy(lm64_C)
kable(lm128_Ca[c(1:4),], digits = 4)
kable(lm64_Ca[c(1:4),], digits = 4)
lm128C_coef<- summary(lm128_C)$coefficients
lm64C_coef<-summary(lm64_C)$coefficients#Lets graph these coefficients so we can see all these at a glance
pe_graphC<-c(lm64C_coef[2:4,1],lm128C_coef[2:4,1])
pe_graphC
barplot(pe_graphC, main = "Price Elasticity", xlab = "Tide64's PE_______________________Tide128's PE", col = rainbow(6), names.arg = c('Cross Tide','Own', 'Cross Wisk','Own', 'Cross Tide', 'Cross Wisk' ))
lm128_D<-lm(log(svelocity128) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64) + week + factor(store), data = detergent_DF_2)
lm64_D <- lm(log(svelocity64) ~ log(p_tide128)+log(p_tide64)+ log(p_wisk64) + week+ factor(store), data = detergent_DF_2)
lm128D_coef<- summary(lm128_D)$coefficients
lm64D_coef<-summary(lm64_D)$coefficients#Lets graph these coefficients so we can see all these at a glance
library(broom)
library(knitr)
lm128_D <- tidy(lm128_D)
lm64_D <- tidy(lm64_D)
kable(lm64_D[c(1:4),], digits = 4)
#Comparison
kable(lm64_Ca[c(1:4),], digits = 4)
#Comparison
kable(lm128_D[c(1:4),], digits = 4)
kable(lm128_Ca[c(1:4),], digits = 4)
pe_graphD<-c(lm64D_coef[2:4,1],lm128D_coef[2:4,1])
pe_graphD
barplot(pe_graphD, main = "Price Elasticity", xlab = "Tide64's PE_______________________Tide128's PE", col = rainbow(6), names.arg = c('Cross Tide','Own', 'Cross Wisk','Own', 'Cross Tide', 'Cross Wisk' ))
lm128_E<-lm(log(q_tide128) ~ log(p_tide128)+log(p_tide64) +log(p_wisk64) + week + factor(store), data = detergent_DF_2)
lm64_E<- lm(log(q_tide64) ~ log(p_tide128)+log(p_tide64) +log(p_wisk64) + week+ factor(store), data = detergent_DF_2)
lm128_Ea = tidy(lm128_E)
lm64_Ea = tidy(lm64_E)
kable(lm128_D[c(1:4),], digits = 4)
kable(lm128_Ea[c(1:4),], digits = 4)
kable(lm64_D[c(1:4),], digits = 4)
kable(lm64_Ea[c(1:4),], digits = 4)
lm128E_coef<- summary(lm128_E)$coefficients
lm64E_coef<-summary(lm64_E)$coefficients#Lets graph these coefficients so we can see all these at a glance
pe_graphE<-c(lm64E_coef[2:4,1],lm128E_coef[2:4,1])
pe_graphE
barplot(pe_graphE, main = "Price Elasticity", xlab = "Tide64's PE_______________________Tide128's PE", col = rainbow(6), names.arg = c('Cross Tide','Own', 'Cross Wisk','Own', 'Cross Tide', 'Cross Wisk' ))
baseprice128 = mean(detergent_DF_2$p_tide128)
baseprice128
baseprice64 = mean(detergent_DF_2$p_tide64)
baseprice64
stores <- length(unique(detergent_DF_2$store))
basevolume128 = stores * 52 * mean(detergent_DF_2$q_tide128)
basevolume64 = stores * 52 * mean(detergent_DF_2$q_tide64)
basevolume128
basevolume64
Bprofit128 = basevolume128 * ((baseprice128*0.75) - 0.027*128)
Bprofit64 = basevolume64 * ((baseprice64*0.75) - 0.027*64)
BaseTotalProfit <- Bprofit128 + Bprofit64
BaseTotalProfit
pricechange = 0.05
# Specify the function
demand_change <- function(price_change1, price_change2, price_elasticity1, price_elasticity2, price_elasticity3, basequantity) {
# New demand from method 1
quantity_change_1 = ((1 + price_change1)^price_elasticity1) * ((1 + price_change2)^price_elasticity2) *
((1)^price_elasticity3)
#Get new quantity from ratio of new / old
NewQuantity = quantity_change_1 * basequantity
# Return results as a list
return(NewQuantity)
}
New_Q128_1 <- demand_change(0.05, 0.05, -2.3836, 0.2097,1.1648, basevolume128)
New_Q64_1 <- demand_change(0.05,0.05,-1.4867,0.9028, -0.2809, basevolume64)
New_Q128_2 <- demand_change(-0.05, -0.05, -2.3836, 0.2097,1.1648, basevolume128)
New_Q64_2 <- demand_change(-0.05,-0.05,-1.4867,0.9028, -0.2809, basevolume64)
New_Q128_3 <- demand_change(0.05, -0.05, -2.3836, 0.2097,1.1648, basevolume128)
New_Q64_3 <- demand_change(-0.05,0.05,-1.4867,0.9028, -0.2809, basevolume64)
New_Q128_4 <- demand_change(-0.05, 0.05,-2.3836, 0.2097,1.1648, basevolume128)
New_Q64_4 <- demand_change(0.05,-0.05,-1.4867, 0.9028, -0.2809, basevolume64)
Profit1 = (New_Q128_1 * ((baseprice128*1.05*0.75) - 0.027*128)) + (New_Q64_1 * ((baseprice64*1.05*0.75) - 0.027*64))
Profit2 = (New_Q128_2 * ((baseprice128*0.95*0.75) - 0.027*128)) + (New_Q64_2 * ((baseprice64*0.95*0.75) - 0.027*64))
Profit3 = (New_Q128_3 * ((baseprice128*1.05*0.75) - 0.027*128)) + (New_Q64_3 * ((baseprice64*0.95*0.75) - 0.027*64))
Profit4 = (New_Q128_4 * ((baseprice128*0.95*0.75) - 0.027*128)) + (New_Q64_4 * ((baseprice64*1.05*0.75) - 0.027*64))
library(scales)
del_price_128 = c(0, 0.05, -0.05, 0.05, -0.05)
del_price_64 = c(0, 0.05, -0.05, -0.05, 0.05)
q_128 = c(basevolume128, New_Q128_1, New_Q128_2, New_Q128_3, New_Q128_4)
q_64 = c(basevolume64, New_Q64_1, New_Q64_2, New_Q64_3, New_Q64_4)
#TotalProfitsW = c(TotalProfit1, TotalProfit2, TotalProfit3, TotalProfit4)
TotalProfitsR = c(BaseTotalProfit, Profit1, Profit2, Profit3, Profit4)
ChangeInPrice = c("Base Price", "Both +", "Both-", "T128 + T64 -", "T128 - T64 +")
Color = c(1, 1, 2, 2,2)
Price_Change<- as.factor(paste('128',del_price_128,'64',del_price_64, sep = "|"))
NewTable <- data.frame(del_price_128, del_price_64, q_128, q_64,Price_Change, TotalProfitsR, ChangeInPrice, Color)
NewTable
# ggplot(data = NewTable, aes(ChangeInPrice,TotalProfitsR, color = ChangeInPrice)) +
#    geom_point(size=10,show.legend = NA) +
#    theme_classic() +
#    scale_y_continuous(labels = comma) +
#    geom_label(
#     label="Profit from Recommended change",
#     x=1.75,
#     y=2400500,
#     label.padding = unit(0.55, "lines"), # Rectangle size around label
#     label.size = 0.35,
#     color = "black")
plot2 <-
ggplot(data = NewTable, aes(reorder(ChangeInPrice,TotalProfitsR), TotalProfitsR, fill = Color)) +
geom_col() +
theme_classic() +
theme(legend.position = "none") +
xlab("Change in Price") +
ylab("Total Profit $") +
ggtitle("Which One is Higher Than the Base Profit?")
plot2
New_Q128_5 <- demand_change(0.05, 0, -2.11, 0.211, 1.1648, basevolume128)
New_Q64_5 <- demand_change(0.05, 0 ,1.16,-1.585 , -0.2809, basevolume64)
New_Q128_6 <- demand_change(0, 0.05, -2.11, 0.211, 1.1648, basevolume128)
New_Q64_6 <- demand_change(0, 0.05 ,1.16,-1.585 , -0.2809, basevolume64)
New_Q128_7 <- demand_change(-0.05, 0, -2.11, 0.211, 1.1648, basevolume128)
New_Q64_7 <- demand_change(-0.05, 0 ,1.16,-1.585 , -0.2809, basevolume64)
New_Q128_8 <- demand_change(0, -0.05, -2.11, 0.211, 1.1648, basevolume128)
New_Q64_8 <- demand_change(0, -0.05 ,1.16,-1.585 , -0.2809, basevolume64)
#Increase price 128 by 5% but keep 64 the same
Profit5 = (New_Q128_5 * ((baseprice128*1.05*0.75) - 0.027*128)) + (New_Q64_5 * ((baseprice64*1.0*0.75) - 0.027*64))
#Keep price 128 the same but increase price 64 by 5%
Profit6 = (New_Q128_6 * ((baseprice128*1.0*0.75) - 0.027*128)) + (New_Q64_6 * ((baseprice64*1.05*0.75) - 0.027*64))
#Decrease price 128 by 5% but keep 64 the same
Profit7 = (New_Q128_7 * ((baseprice128*.95*0.75) - 0.027*128)) + (New_Q64_7 * ((baseprice64*1.0*0.75) - 0.027*64))
#Keep price 128 the same but decrease price 64 by 5%
Profit8 = (New_Q128_8 * ((baseprice128*1.0*0.75) - 0.027*128)) + (New_Q64_8 * ((baseprice64*0.95*0.75) - 0.027*64))
NewProfits <- c(Profit5, Profit6, Profit7, Profit8)
NewProfits
library(scales)
del_price_128 = c(0, 0.05, -0.05, 0.05, -0.05)
del_price_64 = c(0, 0.05, -0.05, -0.05, 0.05)
q_128 = c(basevolume128, New_Q128_1, New_Q128_2, New_Q128_3, New_Q128_4)
q_64 = c(basevolume64, New_Q64_1, New_Q64_2, New_Q64_3, New_Q64_4)
#TotalProfitsW = c(TotalProfit1, TotalProfit2, TotalProfit3, TotalProfit4)
TotalProfitsR = c(BaseTotalProfit, Profit1, Profit2, Profit3, Profit4)
ChangeInPrice = c("Base Price", "Both +", "Both-", "T128 + T64 -", "T128 - T64 +")
Color = c(1, 1, 2, 2,1)
Price_Change<- as.factor(paste('128',del_price_128,'64',del_price_64, sep = "|"))
NewTable <- data.frame(del_price_128, del_price_64, q_128, q_64,Price_Change, TotalProfitsR, ChangeInPrice, Color)
NewTable
# ggplot(data = NewTable, aes(ChangeInPrice,TotalProfitsR, color = ChangeInPrice)) +
#    geom_point(size=10,show.legend = NA) +
#    theme_classic() +
#    scale_y_continuous(labels = comma) +
#    geom_label(
#     label="Profit from Recommended change",
#     x=1.75,
#     y=2400500,
#     label.padding = unit(0.55, "lines"), # Rectangle size around label
#     label.size = 0.35,
#     color = "black")
plot2 <-
ggplot(data = NewTable, aes(reorder(ChangeInPrice,TotalProfitsR), TotalProfitsR, fill = Color)) +
geom_col() +
theme_classic() +
theme(legend.position = "none") +
xlab("Change in Price") +
ylab("Total Profit $") +
ggtitle("Which One is Higher Than the Base Profit?")
plot2
