library(dplyr)
detergent_promos <- dt %>% select(week, promoflag) %>%
filter(promoflag == 1)
totalweeks<-length(unique(dt$week))
promoweeks<-length(unique(detergent_promos$week))
store_week_fraction <- paste(promoweeks,totalweeks, sep = '/')
store_week_fraction #Did we lose some data, there isn't the expected 300 weeks.
sum(dt$promoflag)
detergent_DF_2 = subset(detergent_DF, promoflag != 1)
detergent_DF_2$svelocity128 <- (detergent_DF_2$q_tide128/detergent_DF_2$acv)
detergent_DF_2$svelocity64 <- (detergent_DF_2$q_tide64/detergent_DF_2$acv)
SalesVelocity128_B <- sum(detergent_DF_2$svelocity128)
SalesVelocity64_B <- sum(detergent_DF_2$svelocity64)
lm128_C = lm(log(svelocity128) ~ log(p_tide128)+log(p_tide64) + week, data = detergent_DF_2)
lm64_C = lm(log(svelocity64) ~ log(p_tide128)+log(p_tide64) + week, data = detergent_DF_2)
#summary(lm128_C)
#summary(lm64_C)
lm128_Ca<-tidy(lm128_C)
lm64_Ca<-tidy(lm64_C)
kable(lm128_Ca[c(1:3),], digits = 4)
kable(lm64_Ca[c(1:3),], digits = 4)
lm128_D<-lm(log(svelocity128) ~ log(p_tide128)+log(p_tide64) + week + factor(store), data = detergent_DF_2)
lm64_D <- lm(log(svelocity64) ~ log(p_tide128)+log(p_tide64)+ week+ factor(store), data = detergent_DF_2)
library(broom)
library(knitr)
lm128_D <- tidy(lm128_D)
lm64_D <- tidy(lm64_D)
kable(lm64_D[c(1:4),], digits = 4)
kable(lm64_Ca[c(1:3),], digits = 4)
kable(lm128_D[c(1:4),], digits = 4)
kable(lm128_Ca[c(1:3),], digits = 4)
lm128_E<-lm(log(q_tide128) ~ log(p_tide128)+log(p_tide64) + week + factor(store), data = detergent_DF_2)
lm64_E<- lm(log(q_tide64) ~ log(p_tide128)+log(p_tide64) + week+ factor(store), data = detergent_DF_2)
lm128_Ea = tidy(lm128_E)
lm64_Ea = tidy(lm64_E)
kable(lm128_D[c(1:3),], digits = 4)
kable(lm128_Ea[c(1:3),], digits = 4)
kable(lm64_D[c(1:3),], digits = 4)
kable(lm64_Ea[c(1:3),], digits = 4)
baseprice128 = mean(detergent_DF_2$p_tide128)
baseprice64 = mean(detergent_DF_2$p_tide64)
stores <- length(unique(detergent_DF_2$store))
basevolume128 = stores * 52 * mean(detergent_DF_2$q_tide128)
basevolume64 = stores * 52 * mean(detergent_DF_2$q_tide64)
basevolume128
basevolume64
Bprofit128 = basevolume128 * ((baseprice128*0.75) - 0.25)
Bprofit64 = basevolume64 * ((baseprice64*0.75) - 0.25)
BaseTotalProfit <- Bprofit128 + Bprofit64
BaseTotalProfit
pricechange = 0.05
# Specify the function
demand_change <- function(price_change1, price_change2, price_elasticity1, price_elasticity2, basequantity) {
# New demand from method 1
quantity_change_1 = ((1 + price_change1)^price_elasticity1) * ((1 + price_change2)^price_elasticity2)
#Get new quantity from ratio of new / old
NewQuantity = quantity_change_1 * basequantity
# Return results as a list
return(NewQuantity)
}
New_Q128_1 <- demand_change(0.05, 0.05, -2.11, 0.211, basevolume128)
New_Q64_1 <- demand_change(0.05,0.05,1.16,-1.585, basevolume64)
New_Q128_2 <- demand_change(-0.05, -0.05, -2.11, 0.211, basevolume128)
New_Q64_2 <- demand_change(-0.05,-0.05,1.16,-1.585, basevolume64)
New_Q128_3 <- demand_change(0.05, 0.05, -2.11, 0.211, basevolume128)
New_Q64_3 <- demand_change(-0.05,-0.05,1.16,-1.585, basevolume64)
New_Q128_4 <- demand_change(-0.05, -0.05, -2.11, 0.211, basevolume128)
New_Q64_4 <- demand_change(0.05,0.05,1.16,-1.585, basevolume64)
#Total Profit calculations
TotalProfit1 <- (New_Q128_1* (baseprice128*1.05))*(New_Q64_1* (baseprice64*1.05))
TotalProfit2 <- (New_Q128_2*(baseprice128*0.95))*(New_Q64_2* (baseprice64*0.95))
TotalProfit3 <- (New_Q128_3*(baseprice128*1.05))*(New_Q64_3*(baseprice64*0.95))
TotalProfit4 <- (New_Q128_4*(baseprice128*0.95))*(New_Q64_4* (baseprice64*1.05))
library(scales)
del_price_128 = c(0.05, -0.05, 0.05, -0.05)
del_price_64 = c(0.05, -0.05, -0.05, 0.05)
q_128 = c(New_Q128_1, New_Q128_2, New_Q128_3, New_Q128_4)
q_64 = c(New_Q64_1, New_Q64_2, New_Q64_3, New_Q64_4)
TotalProfits = c(TotalProfit1, TotalProfit2, TotalProfit3, TotalProfit4)
Price_Change<- as.factor(paste('128',del_price_128,'64',del_price_64, sep = "|"))
NewTable <- data.frame(del_price_128, del_price_64, q_128, q_64,Price_Change, TotalProfits)
NewTable
plot(NewTable$Price_Change, NewTable$TotalProfits)
ggplot(data = NewTable, aes(Price_Change,TotalProfits))+geom_point(size=10,show.legend = NA)+scale_y_continuous(labels = comma)
lm128
lm128_B
lm128_C
lm128_E
lm(formula = log(svelocity128) ~ log(p_tide128) + log(p_tide64),
data = dt)
knitr::opts_chunk$set(echo = TRUE)
#install.packages('devtools')#Packages required
#devtools::install_github("ropensci/skimr")
#install.packages('arm')#to plot coefficients
load(file = "Detergent.RData")
dt <- detergent_DF
library(skimr)
library(psych)
library(ggplot2)
library(arm)
library(broom)
library(knitr)
skim(dt)
head(dt)
#Make Revenue column for each product
dt$T128Revenue <- dt$q_tide128 * dt$p_tide128
dt$T64Revenue <- dt$q_tide64 * dt$p_tide64
dt$WiskRevenue <- dt$q_wisk64 * dt$p_wisk64
TotalRevenue <- sum(dt$T128Revenue) + sum(dt$T64Revenue) + sum(dt$WiskRevenue)
T128Rev <- (sum(dt$T128Revenue) / TotalRevenue) * 100
T64Rev <- (sum(dt$T64Revenue) / TotalRevenue) * 100
WiskRev <- (sum(dt$WiskRevenue) / TotalRevenue) * 100
TotalRevenue1 <- format(round(TotalRevenue, 2), nsmall = 2)
T128Rev1 <- format(round(T128Rev, 2), nsmall = 2)
T64Rev1 <- format(round(T64Rev, 2), nsmall = 2)
WiskRev1 <- format(round(WiskRev, 2), nsmall = 2)
Mean128 <- mean(dt$p_tide128)
Mean64 <- mean(dt$p_tide64)
MeanW <- mean(dt$p_wisk64)
SD128 <- sd(dt$p_tide128)
SD64 <- sd(dt$p_tide64)
SDW <- sd(dt$p_wisk64)
Med128 <- median(dt$p_tide128)
Medn64 <- median(dt$p_tide64)
MednW <- median(dt$p_wisk64)
library(data.table)
Marketshare = c(T128Rev1, T64Rev1, WiskRev1)
MeanPrice = c(Mean128, Mean64, MeanW)
MedianPrice = c(Med128, Medn64, MednW)
Std.Dev = c(SD128, SD64, SDW)
Product <- c("Tide 128 oz", "Tide 64 oz", "Wisk 64 oz")
MarketShare <- data.frame(Product, Marketshare, MeanPrice, MedianPrice, Std.Dev)
describe(dt)
MarketShare
dt$PriceGap1 <- dt$p_tide128 - dt$p_tide64
dt$PriceGap2 <- dt$p_tide64 - dt$p_wisk64
MeanPG1 <- mean(dt$PriceGap1)
MeanPG2 <- mean(dt$PriceGap2)
SDPG1 <- sd(dt$PriceGap1)
SDPG2 <- sd(dt$PriceGap2)
MedPG1 <- median(dt$PriceGap1)
MedPG2 <- median(dt$PriceGap2)
MeanPriceGap = c(MeanPG1, MeanPG2)
MedianPriceGap = c(MedPG1, MedPG2)
Std.DevPriceGap = c(SDPG1, SDPG2)
PriceGap <- c("Tide128- Tide64", "Tide64 - Wisk64")
PriceGap <- data.frame(PriceGap, MeanPriceGap, MedianPriceGap, Std.DevPriceGap)
PriceGap
par(mfrow=c(1,2))#Set the plotting area into a 1*2 array
#Set axis to the same for better comparison
hist(dt$PriceGap1, freq = F, col = "steelblue", breaks = 50, xlab = "Price Gap 1 ($)", main = "Price Gap of Tide 128 - Tide 64",
xlim = c(-3,8))
hist(dt$PriceGap2, freq = F, col = "orange", breaks = 50, xlab = "Price Gap 2 ($)", main = "Price Gap of Tide 64 - Wisk 64",xlim = c(-3,8))
par(mfrow=c(1,1))
dt$svelocity128 <- (dt$q_tide128/dt$acv)
dt$svelocity64 <- (dt$q_tide64/dt$acv)
SalesVelocity128 <- sum(dt$svelocity128)
SalesVelocity64 <- sum(dt$svelocity64)
SalesVelocity128
SalesVelocity64
lm128 = lm(log(svelocity128) ~ log(p_tide128)+log(p_tide64), data = dt)
lm64 = lm(log(svelocity64) ~ log(p_tide128)+log(p_tide64), data = dt)
summary(lm128)
summary(lm64)
lm128_coef<- summary(lm128)$coefficients
lm64_coef<-summary(lm64)$coefficients#Lets graph these coefficients so we can see all these at a glance
pe_graph<-c(lm64_coef[2:3,1],lm128_coef[2:3,1])
pe_graph
barplot(pe_graph, main = "Price Elasticity", xlab = "Tide64's price elasticities              Tide128's price elasticities", col = rainbow(4), names.arg = c('Cross','Own', 'Own','Cross' ))
dt$week<-as.integer(dt$week)
lm128_B <- lm(log(svelocity128) ~ log(p_tide128)+log(p_tide64) + week, data = dt)
lm64_B <- lm(log(svelocity64) ~ log(p_tide128)+log(p_tide64) + week, data = dt)
lm128_Ba<-tidy(lm128_B)
lm64_Ba<-tidy(lm64_B)
kable(lm128_Ba[c(1:3),], digits = 4)
kable(lm64_Ba[c(1:3),], digits = 4)
summary(lm128_B)
summary(lm64_B)
library(dplyr)
detergent_promos <- dt %>% select(week, promoflag) %>%
filter(promoflag == 1)
totalweeks<-length(unique(dt$week))
promoweeks<-length(unique(detergent_promos$week))
store_week_fraction <- paste(promoweeks,totalweeks, sep = '/')
store_week_fraction #Did we lose some data, there isn't the expected 300 weeks.
sum(dt$promoflag)
detergent_DF_2 = subset(detergent_DF, promoflag != 1)
detergent_DF_2$svelocity128 <- (detergent_DF_2$q_tide128/detergent_DF_2$acv)
detergent_DF_2$svelocity64 <- (detergent_DF_2$q_tide64/detergent_DF_2$acv)
SalesVelocity128_B <- sum(detergent_DF_2$svelocity128)
SalesVelocity64_B <- sum(detergent_DF_2$svelocity64)
lm128_C = lm(log(svelocity128) ~ log(p_tide128)+log(p_tide64) + week, data = detergent_DF_2)
lm64_C = lm(log(svelocity64) ~ log(p_tide128)+log(p_tide64) + week, data = detergent_DF_2)
#summary(lm128_C)
#summary(lm64_C)
lm128_Ca<-tidy(lm128_C)
lm64_Ca<-tidy(lm64_C)
kable(lm128_Ca[c(1:3),], digits = 4)
kable(lm64_Ca[c(1:3),], digits = 4)
lm128_D<-lm(log(svelocity128) ~ log(p_tide128)+log(p_tide64) + week + factor(store), data = detergent_DF_2)
lm64_D <- lm(log(svelocity64) ~ log(p_tide128)+log(p_tide64)+ week+ factor(store), data = detergent_DF_2)
library(broom)
library(knitr)
lm128_D <- tidy(lm128_D)
lm64_D <- tidy(lm64_D)
kable(lm64_D[c(1:4),], digits = 4)
kable(lm64_Ca[c(1:3),], digits = 4)
kable(lm128_D[c(1:4),], digits = 4)
kable(lm128_Ca[c(1:3),], digits = 4)
lm128_E<-lm(log(q_tide128) ~ log(p_tide128)+log(p_tide64) + week + factor(store), data = detergent_DF_2)
lm64_E<- lm(log(q_tide64) ~ log(p_tide128)+log(p_tide64) + week+ factor(store), data = detergent_DF_2)
lm128_Ea = tidy(lm128_E)
lm64_Ea = tidy(lm64_E)
kable(lm128_D[c(1:3),], digits = 4)
kable(lm128_Ea[c(1:3),], digits = 4)
kable(lm64_D[c(1:3),], digits = 4)
kable(lm64_Ea[c(1:3),], digits = 4)
baseprice128 = mean(detergent_DF_2$p_tide128)
baseprice64 = mean(detergent_DF_2$p_tide64)
stores <- length(unique(detergent_DF_2$store))
basevolume128 = stores * 52 * mean(detergent_DF_2$q_tide128)
basevolume64 = stores * 52 * mean(detergent_DF_2$q_tide64)
basevolume128
basevolume64
Bprofit128 = basevolume128 * ((baseprice128*0.75) - 0.25)
Bprofit64 = basevolume64 * ((baseprice64*0.75) - 0.25)
BaseTotalProfit <- Bprofit128 + Bprofit64
BaseTotalProfit
pricechange = 0.05
# Specify the function
demand_change <- function(price_change1, price_change2, price_elasticity1, price_elasticity2, basequantity) {
# New demand from method 1
quantity_change_1 = ((1 + price_change1)^price_elasticity1) * ((1 + price_change2)^price_elasticity2)
#Get new quantity from ratio of new / old
NewQuantity = quantity_change_1 * basequantity
# Return results as a list
return(NewQuantity)
}
New_Q128_1 <- demand_change(0.05, 0.05, -2.11, 0.211, basevolume128)
New_Q64_1 <- demand_change(0.05,0.05,1.16,-1.585, basevolume64)
New_Q128_2 <- demand_change(-0.05, -0.05, -2.11, 0.211, basevolume128)
New_Q64_2 <- demand_change(-0.05,-0.05,1.16,-1.585, basevolume64)
New_Q128_3 <- demand_change(0.05, 0.05, -2.11, 0.211, basevolume128)
New_Q64_3 <- demand_change(-0.05,-0.05,1.16,-1.585, basevolume64)
New_Q128_4 <- demand_change(-0.05, -0.05, -2.11, 0.211, basevolume128)
New_Q64_4 <- demand_change(0.05,0.05,1.16,-1.585, basevolume64)
#Total Profit calculations
TotalProfit1 <- (New_Q128_1* (baseprice128*1.05))*(New_Q64_1* (baseprice64*1.05))
TotalProfit2 <- (New_Q128_2*(baseprice128*0.95))*(New_Q64_2* (baseprice64*0.95))
TotalProfit3 <- (New_Q128_3*(baseprice128*1.05))*(New_Q64_3*(baseprice64*0.95))
TotalProfit4 <- (New_Q128_4*(baseprice128*0.95))*(New_Q64_4* (baseprice64*1.05))
library(scales)
del_price_128 = c(0.05, -0.05, 0.05, -0.05)
del_price_64 = c(0.05, -0.05, -0.05, 0.05)
q_128 = c(New_Q128_1, New_Q128_2, New_Q128_3, New_Q128_4)
q_64 = c(New_Q64_1, New_Q64_2, New_Q64_3, New_Q64_4)
TotalProfits = c(TotalProfit1, TotalProfit2, TotalProfit3, TotalProfit4)
Price_Change<- as.factor(paste('128',del_price_128,'64',del_price_64, sep = "|"))
NewTable <- data.frame(del_price_128, del_price_64, q_128, q_64,Price_Change, TotalProfits)
NewTable
plot(NewTable$Price_Change, NewTable$TotalProfits)
ggplot(data = NewTable, aes(Price_Change,TotalProfits))+geom_point(size=10,show.legend = NA)+scale_y_continuous(labels = comma)
lm128
lm128_B
lm128_C
lm128_E
lm(formula = log(svelocity128) ~ log(p_tide128) + log(p_tide64),
data = dt)
lm128 = lm(log(svelocity128) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64), data = dt)
lm64 = lm(log(svelocity64) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64), data = dt)
summary(lm128)
summary(lm64)
lm128_coef<- summary(lm128)$coefficients
lm64_coef<-summary(lm64)$coefficients#Lets graph these coefficients so we can see all these at a glance
pe_graph<-c(lm64_coef[2:3,1],lm128_coef[2:3,1])
pe_graph
barplot(pe_graph, main = "Price Elasticity", xlab = "Tide64's price elasticities              Tide128's price elasticities", col = rainbow(4), names.arg = c('Cross','Own', 'Own','Cross' ))
dt$week<-as.integer(dt$week)
lm128_B <- lm(log(svelocity128) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64) +  week, data = dt)
lm64_B <- lm(log(svelocity64) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64) + week, data = dt)
lm128_Ba<-tidy(lm128_B)
lm64_Ba<-tidy(lm64_B)
kable(lm128_Ba[c(1:3),], digits = 4)
kable(lm64_Ba[c(1:3),], digits = 4)
summary(lm128_B)
summary(lm64_B)
library(dplyr)
detergent_promos <- dt %>% select(week, promoflag) %>%
filter(promoflag == 1)
totalweeks<-length(unique(dt$week))
promoweeks<-length(unique(detergent_promos$week))
store_week_fraction <- paste(promoweeks,totalweeks, sep = '/')
store_week_fraction #Did we lose some data, there isn't the expected 300 weeks.
sum(dt$promoflag)
detergent_DF_2 = subset(detergent_DF, promoflag != 1)
detergent_DF_2$svelocity128 <- (detergent_DF_2$q_tide128/detergent_DF_2$acv)
detergent_DF_2$svelocity64 <- (detergent_DF_2$q_tide64/detergent_DF_2$acv)
SalesVelocity128_B <- sum(detergent_DF_2$svelocity128)
SalesVelocity64_B <- sum(detergent_DF_2$svelocity64)
lm128_C = lm(log(svelocity128) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64) +  week, data = detergent_DF_2)
lm64_C = lm(log(svelocity64) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64) + week, data = detergent_DF_2)
#summary(lm128_C)
#summary(lm64_C)
lm128_Ca<-tidy(lm128_C)
lm64_Ca<-tidy(lm64_C)
kable(lm128_Ca[c(1:3),], digits = 4)
kable(lm64_Ca[c(1:3),], digits = 4)
detergent_DF_2$svelocity128 <- (detergent_DF_2$q_tide128/detergent_DF_2$acv)
detergent_DF_2$svelocity64 <- (detergent_DF_2$q_tide64/detergent_DF_2$acv)
SalesVelocity128_B <- sum(detergent_DF_2$svelocity128)
SalesVelocity64_B <- sum(detergent_DF_2$svelocity64)
lm128_C = lm(log(svelocity128) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64) +  week, data = detergent_DF_2)
lm64_C = lm(log(svelocity64) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64) + week, data = detergent_DF_2)
summary(lm128_C)
summary(lm64_C)
lm128_Ca<-tidy(lm128_C)
lm64_Ca<-tidy(lm64_C)
kable(lm128_Ca[c(1:3),], digits = 4)
kable(lm64_Ca[c(1:3),], digits = 4)
detergent_DF_2$svelocity128 <- (detergent_DF_2$q_tide128/detergent_DF_2$acv)
detergent_DF_2$svelocity64 <- (detergent_DF_2$q_tide64/detergent_DF_2$acv)
SalesVelocity128_B <- sum(detergent_DF_2$svelocity128)
SalesVelocity64_B <- sum(detergent_DF_2$svelocity64)
lm128_C = lm(log(svelocity128) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64) +  week, data = detergent_DF_2)
lm64_C = lm(log(svelocity64) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64) + week, data = detergent_DF_2)
summary(lm128_C)
summary(lm64_C)
lm128_Ca<-tidy(lm128_C)
lm64_Ca<-tidy(lm64_C)
kable(lm128_Ca[c(1:4),], digits = 4)
kable(lm64_Ca[c(1:4),], digits = 4)
lm128_D<-lm(log(svelocity128) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64) + week + factor(store), data = detergent_DF_2)
lm64_D <- lm(log(svelocity64) ~ log(p_tide128)+log(p_tide64)+ log(p_wisk64) + week+ factor(store), data = detergent_DF_2)
library(broom)
library(knitr)
lm128_D <- tidy(lm128_D)
lm64_D <- tidy(lm64_D)
kable(lm64_D[c(1:4),], digits = 4)
kable(lm64_Ca[c(1:3),], digits = 4)
kable(lm128_D[c(1:4),], digits = 4)
kable(lm128_Ca[c(1:3),], digits = 4)
lm128_D<-lm(log(svelocity128) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64) + week + factor(store), data = detergent_DF_2)
lm64_D <- lm(log(svelocity64) ~ log(p_tide128)+log(p_tide64)+ log(p_wisk64) + week+ factor(store), data = detergent_DF_2)
library(broom)
library(knitr)
lm128_D <- tidy(lm128_D)
lm64_D <- tidy(lm64_D)
kable(lm64_D[c(1:4),], digits = 4)
kable(lm64_Ca[c(1:4),], digits = 4)
kable(lm128_D[c(1:4),], digits = 4)
kable(lm128_Ca[c(1:4),], digits = 4)
lm128_D<-lm(log(svelocity128) ~ log(p_tide128)+log(p_tide64) + log(p_wisk64) + week + factor(store), data = detergent_DF_2)
lm64_D <- lm(log(svelocity64) ~ log(p_tide128)+log(p_tide64)+ log(p_wisk64) + week+ factor(store), data = detergent_DF_2)
library(broom)
library(knitr)
lm128_D <- tidy(lm128_D)
lm64_D <- tidy(lm64_D)
kable(lm64_D[c(1:4),], digits = 4)
#Comparison
kable(lm64_Ca[c(1:4),], digits = 4)
#Comparison
kable(lm128_D[c(1:4),], digits = 4)
kable(lm128_Ca[c(1:4),], digits = 4)
lm128_E<-lm(log(q_tide128) ~ log(p_tide128)+log(p_tide64) +log(p_wisk64) + week + factor(store), data = detergent_DF_2)
lm64_E<- lm(log(q_tide64) ~ log(p_tide128)+log(p_tide64) +log(p_wisk64) + week+ factor(store), data = detergent_DF_2)
lm128_Ea = tidy(lm128_E)
lm64_Ea = tidy(lm64_E)
kable(lm128_D[c(1:4),], digits = 4)
kable(lm128_Ea[c(1:4),], digits = 4)
kable(lm64_D[c(1:4),], digits = 4)
kable(lm64_Ea[c(1:4),], digits = 4)
pricechange = 0.05
# Specify the function
demand_change <- function(price_change1, price_change2, price_elasticity1, price_elasticity2, price_elasticity3, basequantity) {
# New demand from method 1
quantity_change_1 = ((1 + price_change1)^price_elasticity1) * ((1 + price_change2)^price_elasticity2) *
((1)^price_elasticity3)
#Get new quantity from ratio of new / old
NewQuantity = quantity_change_1 * basequantity
# Return results as a list
return(NewQuantity)
}
New_Q128_1 <- demand_change(0.05, 0.05, -2.11, 0.211,1.1648, basevolume128)
New_Q64_1 <- demand_change(0.05,0.05,1.16,-1.585, -0.2809, basevolume64)
New_Q128_2 <- demand_change(-0.05, -0.05, -2.11, 0.211, 1.1648, basevolume128)
New_Q64_2 <- demand_change(-0.05,-0.05,1.16,-1.585 , -0.2809, basevolume64)
New_Q128_3 <- demand_change(0.05, 0.05, -2.11, 0.211, 1.1648, basevolume128)
New_Q64_3 <- demand_change(-0.05,-0.05,1.16,-1.585 , -0.2809, basevolume64)
New_Q128_4 <- demand_change(-0.05, -0.05, -2.11, 0.211, 1.1648, basevolume128)
New_Q64_4 <- demand_change(0.05,0.05,1.16,-1.585 , -0.2809, basevolume64)
#Total Profit calculations
TotalProfit1 <- (New_Q128_1* (baseprice128*1.05))*(New_Q64_1* (baseprice64*1.05))
TotalProfit2 <- (New_Q128_2*(baseprice128*0.95))*(New_Q64_2* (baseprice64*0.95))
TotalProfit3 <- (New_Q128_3*(baseprice128*1.05))*(New_Q64_3*(baseprice64*0.95))
TotalProfit4 <- (New_Q128_4*(baseprice128*0.95))*(New_Q64_4* (baseprice64*1.05))
library(scales)
del_price_128 = c(0.05, -0.05, 0.05, -0.05)
del_price_64 = c(0.05, -0.05, -0.05, 0.05)
q_128 = c(New_Q128_1, New_Q128_2, New_Q128_3, New_Q128_4)
q_64 = c(New_Q64_1, New_Q64_2, New_Q64_3, New_Q64_4)
TotalProfits = c(TotalProfit1, TotalProfit2, TotalProfit3, TotalProfit4)
Price_Change<- as.factor(paste('128',del_price_128,'64',del_price_64, sep = "|"))
NewTable <- data.frame(del_price_128, del_price_64, q_128, q_64,Price_Change, TotalProfits)
NewTable
plot(NewTable$Price_Change, NewTable$TotalProfits)
ggplot(data = NewTable, aes(Price_Change,TotalProfits))+geom_point(size=10,show.legend = NA)+scale_y_continuous(labels = comma)
knitr::opts_chunk$set(echo = TRUE)
library(psych)
library(tidyverse)
library(knitr)
library(broom)
df <- get(load('Detergent.Rdata'))
head(df, 20)
tail(df, 20)
describe(df)
str(df)
summary(df)
df$salestide128 <- df$p_tide128 * df$q_tide128
df$salestide64 <- df$p_tide64 * df$q_tide64
df$saleswisk64 <- df$p_wisk64 * df$q_wisk64
df$totalweeklysales <- df$salestide128 + df$salestide64 + df$saleswisk64
totalsales<- sum(df$totalweeklysales)
totaltide128 <- sum(df$salestide128)
totaltide64 <- sum(df$salestide64)
totalwisk64 <- sum(df$saleswisk64)
#Sanity Check
totalsales == sum(totaltide128, totaltide64, totalwisk64)
#Market share percentages
mktsharetide128 <- totaltide128/totalsales
mktsharetide64 <- totaltide64/totalsales
mktsharewisk64 <- totalwisk64/totalsales
#Mean, median, and standard deviation for weekly prices taken from:
summary.output <- describe(df)
#creating new variables
df$pricegap1 <- df$p_tide128 - df$p_tide64
df$pricegap2 <- df$p_tide64 - df$p_wisk64
#seeing how the price gaps behave in the dataset
describe(df[15:16])
histgap1 <- hist(df$pricegap1, col = "steelblue3", breaks = 16, main = "Histogram of Pricegap1", xlab = "Price of Tide128oz - Tide64oz", ylab = "# of weekly store occurrences")
histgap1
histgap2 <- hist(df$pricegap2, col = "firebrick1", breaks = 24, main = "Histogram of Pricegap2", xlab = "Price of Tide64oz - Wisk64oz", ylab = "# of weekly store occurrences")
histgap2
df$velocity128 <- df$q_tide128/df$acv
df$velocity64 <- df$q_tide64/df$acv
df$velocitywisk <- df$q_wisk64/df$acv
head(df)
#Tide128
lm1 <- lm(log(velocity128) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64), data = df)
summary(lm1)
#Tide64
lm2 <- lm(log(velocity64) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64), data = df)
summary(lm2)
#Tide128
lm3 <- lm(log(velocity128) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64) + week, data = df)
summary(lm3)
#Tide64
lm4 <- lm(log(velocity64) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64) + week, data = df)
summary(lm4)
describe(df)
totalstoreweeks <- count(df)
total_promos <-sum(df$promoflag)
promo_ratio <-total_promos/totalstoreweeks
promo_ratio
#Creating NON-promo df
df2 <- subset(df, promoflag == 0)
str(df2)
#Tide128
lm5 <- lm(log(velocity128) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64) + week, data = df2)
summary(lm5)
#Tide64
lm6 <- lm(log(velocity64) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64) + week, data = df2)
summary(lm6)
#Tide128
lm7 <- lm(log(velocity128) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64) + week + factor(store), data = df2)
lm7DF <- tidy(lm7)
kable(lm7DF[1:8,], digits = 4)
#Tide64
lm8 <- lm(log(velocity64) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64) + week + factor(store), data = df2)
lm8DF <- tidy(lm8)
kable(lm8DF[1:8,], digits = 4)
lm9 <- lm(log(q_tide128) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64) + week + factor(store), data = df2)
lm9DF <- tidy(lm9)
kable(lm9DF[1:8,], digits = 4)
#Tide64
lm10 <- lm(log(q_tide64) ~ log(p_tide128) + log(p_tide64) + log(p_wisk64) + week + factor(store), data = df2)
lm10DF <- tidy(lm10)
kable(lm10DF[1:8,], digits = 4)
baseprice128 <- mean(df2$p_tide128)
baseprice128
baseprice64 <- mean(df2$p_tide64)
baseprice64
numstores <- 86
# Base Volume = # of Stores * # Weeks in year * Avg. Sales of Product
basevolume128 <- numstores * 52 * mean(df2$salestide128)
basevolume128
# Base Volume = # of Stores * # Weeks in year * Avg. Sales of Product
basevolume64 <- numstores * 52 * mean(df2$salestide64)
basevolume64
#Storing inputs and finding cost per product
retail.margin <- .25
costperoz <- .027
costper128 <- costperoz * 128
costper64 <- costperoz * 64
costper128
costper64
# Finding Base Contribution Margin
baseprice128
baseprice64
stores
basevolume128
basevolume64
basevolume128
