---
title: 'Assignment 2: Demand and Profitability Analysis'
author: "Caleb Aguiar"
date: "January 2021"
output: word_document
urlcolor: blue
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

### Question 1

What are the price elasticities of the three products? 
PE1 -2.5,0.7,1.2
PE2  1.5,-1.5,0.4
PE3  1.2,0.5,-1.2

Based on the functions:

$Q_1 =  A_1P_1^{-2.5}P_2^{1.5}P_3^{1.2}$.

$Q_2 =  A_1P_1^{0.7}P_2^{-1.5}P_3^{0.5}$.

$Q_3 =  A_1P_1^{0.7}P_2^{0.4}P_3^{-1.2}$.


### Question 2

Write down a matrix of price elasticities 

```{r}
PE1<- list(-2.5,0.7,1.2)
PE2<- list(1.5,-1.5,0.4)
PE3<- list(1.2,0.5,-1.2)

cross_price_elasticities<-cbind(c(PE1),c(PE2),c(PE3))
      
colnames(cross_price_elasticities)<-c("PE1","PE2","PE3")
rownames(cross_price_elasticities)<-c("QE1","QE2","QE3")

cross_price_elasticities
```
### Question 3

3a See pdf

3b See pdf

3c

```{r}
price_changes<-list(.05,0,-.15)

cross_pri_func_ex <-function(cross_price_elasticities, price_changes){
    quantitychange<-data.frame("Ratio")
    for(col in 1:ncol(cross_price_elasticities)){
      x<-(cross_price_elasticities[[col,1]])
      y<-(cross_price_elasticities[[col,2]])
      z<-(cross_price_elasticities[[col,3]])
      h<-price_changes[[1]]
      i<-price_changes[[2]]
      j<-price_changes[[3]]
      ratio<-((((1+h)^(x))*((1+i)^(y))*((1+j)^(z))))
      quantitychange <- rbind(quantitychange, ratio)


    }
    return(quantitychange)


}

quantitychange<-cross_pri_func_ex(cross_price_elasticities,price_changes)

print(quantitychange)
```
### Question 4

Calculate what happens to the profits of the three products

4a See pdf

4b 

```{r}

baseprices<- c(2,1.75,1.5)
  
pricechanges<-c(.05,0,-.15)

marginal_costs<- c(.5,.75,.9) #input marginal costs as a vector

retail_margin<-.1 #input our retail margin

ratiocounter<-1

whats_my_profit <-function(baseprices,pricechanges,marginal_costs, retail_margin,quantitychange, ratiocounter){
  profitchange<-array()
  cnt<-0

    for(i in baseprices){
      cnt<-cnt+1
      ratiocounter<-ratiocounter+1
      quant_num<-as.numeric(quantitychange[ratiocounter,1])
      
      newq<-(((i)*(1+pricechanges[cnt]))*(1-retail_margin)-(marginal_costs[cnt]))
      
      oldq<-(((i)*(1-retail_margin)-marginal_costs[cnt]))
      
      value<-quant_num*(newq/oldq)

      profitchange <- rbind(profitchange,value)
    }
    return(profitchange)
}

profit_change<-whats_my_profit(baseprices,pricechanges,marginal_costs, retail_margin,quantitychange,ratiocounter)
print(profit_change)

```

### Question 5

Can you calculate the highest marginal cost at which this price cut is justified for product 3?

When does profit equal zero for product 3, if the price cut is 15%?


```{r}

baseprices3<-c(1.5)

pricechanges3<-c(-.15)

retail_margin3<-.1

ratiocounter3<-3

marginal_costs3<-.9
df<-data.frame()

# Create a for statement to populate the list
for (a in seq(0.01, 0.9, by=0.01)) {

  myprofit<-whats_my_profit(baseprices3,pricechanges3,a, retail_margin3,quantitychange,ratiocounter3)

  if (myprofit[2,1]>1){
    df<-c(df,a,)
    
  }
  
   

}



```






Product 1 Base Quantity  $= -2.5log(2)-1.5(log(1.75))+1.2(log(1.5))$ 

Product 2 Base Quantity   $= .7log(2)-1.5(log(1.75))+0.5(log(1.5))$ 

Product 3 Base Quantity  $= .7log(2)-.4(log(1.75))-1.2(log(1.5))$ 